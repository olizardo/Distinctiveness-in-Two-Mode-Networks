---
title: "Distinctiveness in Two Mode Networks"
author: "Omar Lizardo"
date: "`r Sys.Date()`"
---


# Setup
```{r setup}
   knitr::opts_chunk$set(include = TRUE, 
                       echo = FALSE, 
                       warning = FALSE, 
                       message = FALSE)
   require(here)
   require(kableExtra)
```

# Data
```{r Southern women data}
    A <- matrix(
         c(
          1, 1, 1, 1, 1,  1, 0, 1, 1,  0, 0, 0, 0, 0, 
          1, 1, 1, 0, 1,  1, 1, 1, 0,  0, 0, 0, 0, 0, 
          0, 1, 1, 1, 1,  1, 1, 1, 1,  0, 0, 0, 0, 0, 
          1, 0, 1, 1, 1,  1, 1, 1, 0,  0, 0, 0, 0, 0, 
          0, 0, 1, 1, 1,  0, 1, 0, 0,  0, 0, 0, 0, 0, 
          0, 0, 1, 1, 1,  1, 0, 1, 0,  0, 0, 0, 0, 0, 
          0, 0, 0, 1, 1,  1, 1, 1, 0,  0, 0, 0, 0, 0, 
          0, 0, 0, 1, 1,  0, 1, 1, 1,  0, 0, 0, 0, 0, 
          
          0, 0, 0, 0, 0,  0, 1, 1, 1,  0, 0, 1, 0, 0, 
          0, 0, 0, 0, 0,  0, 0, 1, 1,  1, 0, 1, 0, 0, 
          0, 0, 0, 0, 0,  0, 0, 1, 1,  1, 0, 1, 1, 1,
          0, 0, 0, 0, 0,  0, 1, 1, 1,  1, 0, 1, 1, 1,
          0, 0, 0, 0, 0,  0, 1, 0, 1,  1, 1, 1, 1, 1,
          0, 0, 0, 0, 0,  0, 1, 1, 0,  1, 1, 1, 0, 0,
          0, 0, 0, 0, 0,  0, 0, 0, 1,  0, 1, 0, 0, 0,
          0, 0, 0, 0, 0,  0, 0, 0, 1,  0, 1, 0, 0, 0, 
          
          0, 0, 0, 0, 0,  1, 0, 1, 1,  0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,  0, 0, 1, 1,  0, 0, 0, 0, 0),
          ncol = 14, byrow = TRUE)
     w <- c("EVELYN", "LAURA", "THERESA", "BRENDA", "CHARLOTTE", "FRANCES", "ELEANOR", "RUTH", "VERNE", "MYRA", "KATHERINE", "SYLVIA", "NORA", "HELEN", "OLIVIA", "FLORA", "PEARL", "DOROTHY")
     w.abv <- c("EV", "LA", "TH", "BR", "CH", "FR", "EL", "RU", "VE", "MY", "KA", "SY", "NO", "HE", "OL", "FL", "PE", "DO")
     e <- paste("E", c(1:14), sep = "")
     rownames(A) <- w
     colnames(A) <- e
```

# Matrices
```{r}
   B <- +(!A)
   Bp <- A %*% t(B)
   Bg <- t(t(B) %*% A)
   Dp <- diag(rowSums(A))
   Dg <- diag(colSums(A))
   rownames(Bp) <- w.abv
   colnames(Bp) <- w.abv 
   rownames(Dp) <- w.abv
   colnames(Dp) <- w.abv 
   rownames(Dg) <- colnames(A)
   colnames(Dg) <- colnames(A)
   Bp.n <- solve(Dp) %*% Bp
   Bg.n <- solve(Dg) %*% Bg
   Cp <- as.matrix(sort(rowSums(Bp.n), decreasing = T)/nrow(A))
   rownames(Cp) <- w
   colnames(Cp) <- c("Persons", "Distinctiveness")
   
   Cg <- as.matrix(sort(rowSums(Bg.n), decreasing = T)/ncol(A))
   colnames(Cp) <- c("Distinctiveness")

   
```

# Tables
```{r}
   make.table <- function(t, cap = "", fn) {
      kbl(t, format = "latex", booktabs = T, caption = cap, digits = 2) %>%
         kable_styling(
            latex_options = c("hold_position", "scale_down"),
            ) %>% 
         save_kable(here("Tabs", paste(fn, ".tex", sep = "")))
   }
   make.small.table <- function(t, cap = "", fn) {
      kbl(t, format = "latex", booktabs = T, caption = cap, digits = 2) %>%
         save_kable(here("Tabs", paste(fn, ".tex", sep = "")))
         }
   make.table(A, cap = "", fn = "sw")
   make.table(Bp, cap = "", fn = "Bp")
   make.table(Bg, cap = "", fn = "Bg")
   make.table(Bp.n, cap = "", fn = "Bpn")
   make.table(Bg.n, cap = "", fn = "Bgn")
   make.small.table(Cp, cap = "", fn = "CDp")
   make.small.table(Cg, cap = "", fn = "CDg")
```

`



